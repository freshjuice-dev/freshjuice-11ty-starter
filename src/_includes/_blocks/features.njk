{#
  Features Block
  @param {string} section_title - Section heading
  @param {string} section_description - Section description
  @param {array} features - Feature items (icon, title, description)
  @param {number} columns - Number of columns: 2, 3, 4
  @param {number} _index - Block index for CloudCannon editable binding
#}
{% macro features(props) %}
{%- set columns = props.columns or 3 -%}
{%- set bindPath = 'blocks[' + props._index + ']' if props._index is defined else '' -%}

<section class="py-16 lg:py-24 bg-white"{% if bindPath %} data-cms-bind="#{{ bindPath }}"{% endif %}>
  <div class="container mx-auto px-4">
    {% if props.section_title or props.section_description %}
    <div class="text-center max-w-3xl mx-auto mb-12 lg:mb-16">
      {% if props.section_title %}
      <h2 class="text-3xl md:text-4xl font-bold text-stone-900 mb-4"{% if bindPath %} data-cms-bind="#{{ bindPath }}.section_title"{% endif %}>
        {{ props.section_title }}
      </h2>
      {% endif %}

      {% if props.section_description %}
      <p class="text-xl text-stone-600"{% if bindPath %} data-cms-bind="#{{ bindPath }}.section_description"{% endif %}>
        {{ props.section_description }}
      </p>
      {% endif %}
    </div>
    {% endif %}

    {% if props.features and props.features.length %}
    <div class="grid gap-8 {% if columns == 2 %}md:grid-cols-2{% elif columns == 4 %}md:grid-cols-2 lg:grid-cols-4{% else %}md:grid-cols-2 lg:grid-cols-3{% endif %}"{% if bindPath %} data-cms-bind="#{{ bindPath }}.features"{% endif %}>
      {% for feature in props.features %}
      <div class="text-center p-6"{% if bindPath %} data-cms-bind="#{{ bindPath }}.features[{{ loop.index0 }}]"{% endif %}>
        {% if feature.icon %}
        <div class="inline-flex items-center justify-center w-14 h-14 rounded-xl bg-amber-100 text-orange-700 mb-5">
          {% phosphor feature.icon, "regular", { size: 28 } %}
        </div>
        {% endif %}

        {% if feature.title %}
        <h3 class="text-xl font-semibold text-stone-900 mb-3"{% if bindPath %} data-cms-bind="#{{ bindPath }}.features[{{ loop.index0 }}].title"{% endif %}>
          {{ feature.title }}
        </h3>
        {% endif %}

        {% if feature.description %}
        <p class="text-stone-600"{% if bindPath %} data-cms-bind="#{{ bindPath }}.features[{{ loop.index0 }}].description"{% endif %}>
          {{ feature.description }}
        </p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}
  </div>
</section>
{% endmacro %}
